- CRUD页面配置流程是什么呢？
1. 静态页面配置：添加【搜索表单】和【基础表格】组件
2. 弹窗配置：添加【新增弹窗】和【编辑弹窗】组件
3. 接口，变量配置：
    - 点击【接口】新增可打开接口配置弹窗：这里可以添加当前页面所需接口，包括 请求方式、数据格式、传参 等等，目前的配置参数已基本满足常规的需求
    - 可在左侧菜单栏【变量】新增可打开变量配置弹窗：这里可以添加当前页面所需变量，包括 变量名称、变量类型、变量默认值 等等
4. 页面初始化事件配置：获取城市数据，cityList赋值（非必须）
5. 区域list获取，跟城市联动（非必须）
6. 表单提交事件配置：点击【新增弹窗】的【提交】按钮，触发表单提交事件，将表单数据提交到后端接口
7. 查询筛选事件配置：点击【搜索表单】的【查询】按钮，触发表单查询事件，将查询条件提交到后端接口，获取查询结果
8. 表格展示事件配置：将查询结果展示在【基础表格】组件中
9. 删除事件配置：点击【基础表格】组件的【删除】按钮，触发删除事件，将选中行数据删除
10. 编辑事件配置：点击【基础表格】组件的【编辑】按钮，触发编辑事件，将选中行数据打开【编辑弹窗】进行编辑
11. 详情事件配置：点击【基础表格】组件的【详情】按钮，触发详情事件，将选中行数据打开【详情弹窗】进行展示

- 刚开始配置页面，现在是打开了一个空白画布，我应该从哪里开始呢？
1. 首先选中页面，为了方便对【标题】和【搜索栏】统一进行样式管理，这里先添加一个【Div容器】组件；然后选中该容器组件，再添加【标题】组件；继续选中【Div容器】组件，添加【搜索表单】组件；选中标题组件后，可在右侧属性配置栏支持文字修改，H1/H2/H3等标签修改，直接修改即可；
2. 选中【搜索表单】组件，添加需要的表单组件；之后选中表单组件，即可在右侧属性配置栏进行属性配置：【字段】为需要传递给后端的key值；
3. 之后选中页面，继续添加【基础表格】组件，这两个组件是必须添加的，其他组件根据业务需求添加即可；
4. 之后就是进行事件配置了，根据业务需求添加事件，如搜索表单组件的【提交】、【重置】等事件就需要在这里配置；


- 没有权限应该怎么申请权限呢？
目前该平台入口在运营平台左侧菜单栏，没有权限的同学直接去权限中心申请菜单权限即可: 运营平台右上角【权限中心】 => 【角色管理】中直接给角色名称为【B端低码平台读写】的角色添加成员，用户名称为邮箱前缀；如果没有权限中心权限，可以直接联系 zhouyuan17 添加


- 编辑页的功能说明：
1. 左侧菜单栏：
    - 组件：平台提供的组件，点击可往画布添加
    - 大纲：实时展示当前页面的DOM结构，可拖拽排序，点击可在画布选中
    - 代码：实时展示当前页面配置的JSON信息
    - 接口：配置需要在当前页面使用的接口信息
    - 变量：配置需要在当前页面使用的变量信息
2. 中间画布：
    - 顶部可选择页面宽度，有【保存】、【预览】等操作
    - 中间画布区域实时展示当前配置页面，点击可选中，同时在右侧会展示当前选中组件的配置信息
    - 底部左下角会展示当前添加的Modal弹窗、Drawer抽屉组件，双击可展示
3. 右侧属性配置区域：
    - 属性：展示当前选中组件的属性配置信息，这些信息需要在创建组件时就提前定义好
    - 样式：可配置一些常用的基础样式
    - 事件：给选中组件添加事件，如搜索表单组件的【提交】、【重置】等事件就需要在这里配置
    - 数据：给当前组件添加数据，主要有【静态数据】、【接口请求】、【动态变量】三种，如上方页面在初始化时需要通过接口获取数据，就需要在这里配置


- 如何配置事件流？
1. 点击选中组件，在右侧属性配置区域【事件】中添加事件
2. 添加事件后，可点击【设置事件流】打开事件流配置弹窗；
3. 每一个事件节点可添加方法，平台会提供一些默认方法，比如【页面跳转】、【消息通知】等等；也可以选择已添加组件提供的方法，这些方法需要在组件创建时就定义好，可以根据业务需求，在事件代码中添加自定义逻辑；
3. 事件流执行逻辑：默认按照数组进行存储，在执行时会转化成链表结构：`{action:{...}, next:{...}}`，然后依次往后执行；每一个事件节点可往下一节点传参


- 如何查看事件流执行详情？
按钮添加事件流之后，点击按钮，会在控制台打印出事件流信息：
``` js
=====🚴🏻🚴🏻🚴🏻🚴🏻🚴🏻事件流完整数组： (7) [{…}, {…}, {…}, {…}, {…}, {…}, {…}] 
=====🚴🏻🚴🏻🚴🏻🚴🏻🚴🏻事件流完整链表： {action: {…}, next: {…}}
=====🔥🔥🔥🔥🔥当前事件节点： {action: {…}, next: {…}}
=====🔥🔥🔥🔥🔥当前事件节点上下文参数： {id: 8, …}  // 这里打印的是传递到当前事件节点的参数
```
配置事件时可以在这里查看具体执行流程和传递参数，从而决定具体应该怎么配置参数；如果想往下一事件节点增加参数，在配置当前事件节点，可通过【发送数据】进行添加；


- 如何进行表单配置？
1. 目前支持文本输入框、下拉选择框、单选、多选、级联选择、时间选择、时间范围选择、图片上传等常用的表单组件，可满足大多数表单字段的创建需求。
2. 表单组件需要先添加【表单容器】组件，然后选中该容器，往里面添加表单组件即可；选中表单组件后，在右侧属性配置区域【属性】中可以配置表单组件的属性，如【字段名】、【选项列表】、【默认值】等；


- 如何实现表单联动？

`例1：表单字段a只有当表单字段b值等于1时才展示`
1. 选中字段a组件， 属性 => 组件显隐，点击【显示条件】的fx图标，打开逻辑编辑器面板；
2. 在面板右侧参数和变量中找到字段b，点击添加到编辑器：
``` js
context.Form_8ycpmhrdyg.b === 1 ? true : false
```
3. 添加这种的三元表达式，保存后立即生效；

`例2：表单字段a选择后，清空或重置表单字段b的值`
1. 选中字段a组件，添加onChange事件，设置事件流，打开事件流配置面板；
2. 添加一个事件节点，点击打开【事件行为配置】弹窗，点击【组件方法】，目标组件选择当前的 Form 组件，组件方法选择【设置表单数据】，发送数据中添加需要重置或清空的字段，参数值为空就是清空；


- 下拉框表单组件如何配置下拉list？
【下拉框】组件下拉list可以在【数据】tab下进行配置，目前支持 静态数据/接口请求/动态变量 三种数据来源配置：
1. 静态数据就是直接配置下拉list数组，直接编写即可；字段映射默认为`{label:'', value:''}`，也可在【属性 - 字段映射】中修改key值；
2. 如果是通过接口获取的，需要先在编辑页左侧的【接口】tab下先添加接口配置，然后再在【数据来源】中选择【接口请求】；【数据处理】可以配置接口返回的字段映射，默认为 `data.list`
3. 如果想通过变量获取，可以先在编辑页左侧的【变量】下添加变量数据，然后选择【动态变量】，点击【fx】按钮添加变量即可；


- 日期范围表单组件如何配置开始时间和结束时间？
1. 【日期范围】组件可在【属性 - 字段分解】中拆成 `start_time` 和 `end_time`；
2. 日期格式可在【属性 - 表单配置】中进行选择；


- Table表格组件如何配置？
跟其他添加组件的逻辑一样，画布选中页面，直接添加【基础表格】组件；如果画布中不方便直接选择某个组件，可在左侧【大纲】tab 中直接选中：
1. 【操作栏】可添加右上角的按钮，点击 编辑 图标可进行按钮样式的配置；
2. 【表格配置】可进行表格标题、是否单/多选、滚动轴 等配置；
3. 【列配置】可以修改需要在表格中展示的字段，点击 编辑 图标可以进行每列的样式和展示配置，可配置是否可点击、是否可复制、显示格式 等等，基本能满足常见的表格字段展示场景；
4. 【展开配置】可配置树形结构数据，【分页配置】可进行右下角分页DOM的配置；
5. 表格list跟上方下拉框list配置一样，在【数据】tab下直接配置，需要先添加获取list接口，然后再添加即可；
> 【基础表格】组件算是低码平台中比较复杂的组件，里面有比较多配置项，一般常用的就【列配置】，其他的保持默认配置就行~


- Table表格中如何配置字段映射展示？
1. 选中Table组件，在 列配置 中选中需要映射的字段，默认展示当前返回的字段值，如果需要修改，点击 编辑 图标，在弹窗中配置即可；
2. 如果需要自定义渲染，可在【自定义】- 【自定义渲染】中输入代码即可：
``` js
// 如需要通过变量获取当前状态的label值
function render(text, record, index, variables) {
    const config = variables.statusConfig.find((i) => i.value === text)
    return config?.label || '-'
}
```

- 如何配置查询事件？
查询事件流程分析：`点击查询按钮 => 获取表单值 => 调list接口 => Table表格刷新`
1. 直接选中【搜索表单】组件，点击右侧【事件】，点击【添加事件 - 查询事件】，再点击【设置事件流】,默认会进入到一个只有【开始】、【结束】事件流配置面板；
2. 鼠标悬浮 【开始】和【结束】节点中间，会出现【普通节点】和【分支节点】的选项，然后点击【普通节点】，即可添加一个事件节点；
3. 接下来开始事件配置；点击事件卡片，会出现【事件行为配置】弹窗，点击【组件 - 组件方法】，在这里选择刚添加的【基础表格】组件的【搜索】方法：

>【搜索表单】组件的 查询 按钮已默认可以获取所有表单数据，并且 事件流 已默认支持将上一节点的数据传递到下一节点，所以这里不用单独配置 获取表单值 的事件节点；这里【组件方法】需要在创建组件的时候就定义好，比如这里的 搜索 是在创建【基础表格】组件时向外暴露的方法；【发送数据】支持自定义发送到下一事件节点的数据，默认支持可以拿到上一节点的所有key值，支持模板语法`${}`和变量配置；

由于【基础表格】的 搜索 方法已经在组件代码中编写了重新获取数据源的逻辑，所以这里配置的事件流只需要添加搜索方法，就可以实现调list接口和表格刷新的逻辑（因为在上方添加Table表格时，已经将数据源配置为通过list接口获取）

事件流配置完成后，点击【查询】按钮，理论上应该能够看到接口请求，并能够更新页面的list数据了


- 如何配置重置事件？
事件流创建的逻辑都是一样的，这里需要先梳理重置事件的执行流程：`重置表单值 => 调Table组件的搜索方法`；所以按照这个流程添加配置事件流即可：先添加【搜索表单】组件的【表单重置】方法，再添加【基础表格】组件的【搜索】方法就可以了~


- 事件流执行原理是什么？
1. 点击按钮，触发事件流执行；
2. 获取事件流数组，转换成链表结构`{action:{...}, next:{...}}`
3. 执行`action`事件，判断事件类型，如果是组件方法通过组件ID获取组件，拿到组件方法，执行，并将参数传递给下一事件节点；
4. 递归执行next中下一事件节点；
5. 如果遇到分支节点，先判断上一事件节点返回结果，根据返回结果成功与否执行不同的分支事件节点；


- 如何配置新建/编辑事件？
1. 【新建】、【详情】和【编辑】事件需要通过Modal弹窗组件来展示，所以需要再增加一个Modal弹窗组件，用来展示弹窗内容；不想用Modal弹窗组件也可以用Drawer抽屉组件来展示弹窗内容；新增的Modal弹窗组件和Drawer抽屉组件在画布左下角，双击即可展示
2. 添加表单需要先增加一个【Form容器】组件，然后再往里面添加表单组件；表单组件的配置跟上方【搜索表单】组件里添加的表单是一样的，目前支持 输入框、下拉框、时间选择、图片上传、单选/多选 等等，满足常见的表单提交场景；
3. 【属性-校验规则】里可以添加表单校验规则，【组件显隐】里可以配置是否跟其他组件联动显示或隐藏；
4. 表单创建之后，就是配置提交接口，然后添加【确认】事件的事件流；
5. 【新建】和【编辑】事件共用一个Modal弹窗，可以通过定义一个modalType变量来定义弹窗打开类型，比如在配置【编辑】事件事件流时，首先添加一个变量赋值的事件节点

B端CURD页面基本上就是增删改查的交互逻辑，变量、接口、事件、传参这些之前需要在前端代码中编写的逻辑现在都已经抽离成了配置项，现在对于常规的业务场景，可以通过这个低码平台快速产出一个页面。


- 如何进行页面发布？
1. 如果想嵌入到运营平台中，需要先回到平台首页，点击当前页面卡片左下角 编辑 图标，在【页面路径】中输入嵌入的页面url，再选择所属平台为运营平台；
2. 再进入到该页面编辑页，页面创建完成后，【保存】，【发布】，点击画布右上角【复制】，复制第一个平台菜单链接；
3. 之后在 运营平台-权限中心 创建菜单，然后将复制的链接粘贴到你创建的菜单路径，然后就跟之前的菜单一样添加权限配置，之后刷新运营平台，你配置的菜单就可以访问了：
4. 如果其他平台想通过这种方式创建菜单页面需要联系我们这边开发人员做一下iframe嵌入的兼容处理~


- Table表格组件如何配置字段展示？
表格字段展示目前支持单行文本、多行文本、图片、时间、状态、金额、开关等不同格式，配置入口在 【属性 => 列配置】，点击编辑图标即可配置
1. 单行文本：默认配置，如果列字段就是接口返回的字段，直接就可以展示，不需要多余配置
2. 多行文本：展示配置 => 显示格式 选择多行文本，按照提示需要在 自定义 => 自定义渲染 中，自定义渲染格式：
``` js
// 比如需要根据返回的code展示label值，list是提前定义好的变量：
function render(text, record, index, variables) {
    return variables.list.find(v => v.value === text)?.label || '-';
}
```
3. 时间、金额的显示直接在 显示格式 中选择即可；
4. Switch开关：选择该格式后，在 事件 中添加 列Switch开关 事件，就可以添加相应的事件流配置；
5. 操作：选择该格式后，可以进行操作按钮配置，添加之后，在 事件 中添加对应的事件，就可以开始事件流配置了；


- 接口如何进行传参呢？
一般接口参数配置在 接口 => 接口配置 => 发送参数，这里假设从事件流传入的参数为 `{a:1, b: 'test', c: [111,222]， status: 1}`：
1. 静态值：如果有些接口需要固定传入某个参数，可以直接添加一个静态值参数，直接在参数值中输入即可；
2. 变量：如果参数值想获取某个已定义的变量，直接输入即可，如：`context.variable.recordDetail.id`
3. 模板语法：如果需要从传入参数中获取变量，可以使用模板语法，支持数组的join、map等方法
    - 如参数名 c 需要将传入参数值逗号分隔，在参数值中输入：`${c.join(',')}` 即可；
    - 如果有一个不属于事件流传入参数的参数名 `price`，需要将 `a*100`，那就需要这样写：`${data.a * 100}`；
4. 函数变量：如果需要进行比较复杂的处理，可以点击函数图标，在函数模板中输入函数即可，如这里需要根据传入的status来进行判断:
``` js
function run() {
    const {status} = context.eventParams;
    return status === 1 ? 0 : 1;
}
```